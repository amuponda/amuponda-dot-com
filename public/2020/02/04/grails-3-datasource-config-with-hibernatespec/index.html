<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Grails 3 datasource config with HibernateSpec - A. Muponda</title><meta name="Description" content="This is my cool site"><meta property="og:title" content="Grails 3 datasource config with HibernateSpec" />
<meta property="og:description" content="The default implementation of HibernateSpec in Grails 3.3.x overrides the datasource&rsquo;s dbCreate value with create-drop. To get around this you simply override the getConfiguration method and set your preferred value for dbCreate. The properties in the map returned by this method take precedence to those in your application.yml
Map getConfiguration() { Collections.singletonMap(Settings.SETTING\_DB\_CREATE, &#34;create-drop&#34;) // change this } It is also worthwhile to note that your default datasource setup also take precedence over the test environment setup." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://amuponda.com/2020/02/04/grails-3-datasource-config-with-hibernatespec/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-02-04T17:58:35+00:00" />
<meta property="article:modified_time" content="2020-02-04T17:58:35+00:00" /><meta property="og:site_name" content="A. Muponda" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Grails 3 datasource config with HibernateSpec"/>
<meta name="twitter:description" content="The default implementation of HibernateSpec in Grails 3.3.x overrides the datasource&rsquo;s dbCreate value with create-drop. To get around this you simply override the getConfiguration method and set your preferred value for dbCreate. The properties in the map returned by this method take precedence to those in your application.yml
Map getConfiguration() { Collections.singletonMap(Settings.SETTING\_DB\_CREATE, &#34;create-drop&#34;) // change this } It is also worthwhile to note that your default datasource setup also take precedence over the test environment setup."/>
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://amuponda.com/2020/02/04/grails-3-datasource-config-with-hibernatespec/" /><link rel="prev" href="https://amuponda.com/2019/12/28/handle-exceptions-in-micronaut-scheduled-tasks/" /><link rel="next" href="https://amuponda.com/2020/02/08/micronaut-openapi-integration/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Grails 3 datasource config with HibernateSpec",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/amuponda.com\/2020\/02\/04\/grails-3-datasource-config-with-hibernatespec\/"
        },"genre": "posts","keywords": "Grails, Grails, Hibernate","wordcount":  186 ,
        "url": "https:\/\/amuponda.com\/2020\/02\/04\/grails-3-datasource-config-with-hibernatespec\/","datePublished": "2020-02-04T17:58:35+00:00","dateModified": "2020-02-04T17:58:35+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Author"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="A. Muponda">atm</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="A. Muponda">atm</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Grails 3 datasource config with HibernateSpec</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Author</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2020-02-04">2020-02-04</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;186 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;One minute&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents"></nav></div>
            </div><div class="content" id="content"><p>The default implementation of <code>HibernateSpec</code> in Grails 3.3.x overrides the datasource&rsquo;s <code>dbCreate</code> value with <code>create-drop</code>. To get around this you simply override the <code>getConfiguration</code> method and set your preferred value for <code>dbCreate</code>. The properties in the map returned by this method take precedence to those in your <code>application.yml</code></p>
<pre tabindex="0"><code>Map getConfiguration() {
    Collections.singletonMap(Settings.SETTING\_DB\_CREATE, &#34;create-drop&#34;) // change this
}
</code></pre><p>It is also worthwhile to note that your default datasource setup also take precedence over the test environment setup. So it is best to setup your datasource in such way that only common settings are in the default setup as stated in the <a href="https://docs.grails.org/4.0.1/guide/conf.html#dataSource" target="_blank" rel="noopener noreffer ">documentation</a>.</p>
<pre tabindex="0"><code>dataSource:
    pooled: true
    jmxExport: true


environments:
    test:
        dataSource:
            driverClassName: org.mariadb.jdbc.Driver
            dialect: org.hibernate.dialect.MySQL5InnoDBDialect
            username: testuser
            password: &#39;&#39;
            dbCreate: update
            url: jdbc:mariadb://localhost/test\_db    
</code></pre><p>Or better yet just return your test datasource config from <code>getConfiguration</code></p>
<pre tabindex="0"><code>@Override
Map getConfiguration() {
    \[
            dataSource: \[
                    dbCreate: &#34;update&#34;,
                    driverClassName: &#34;org.mariadb.jdbc.Driver&#34;,
                    dialect: &#34;org.hibernate.dialect.MySQL5InnoDBDialect&#34;,
                    username: &#34;testuser&#34;,
                    password: &#34;&#34;,
                    url: &#34;jdbc:mariadb://localhost/test\_db&#34;
            \]
    \]
}
</code></pre><p>Please note that this is no longer the case is Grails 4 as <code>HibernateSpec</code> is now fully environment aware. As always you can find an example of how to do this <a href="https://github.com/amuponda/blog-posts/tree/master/grails3-hibernate-spec" target="_blank" rel="noopener noreffer ">github</a>.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-02-04</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://amuponda.com/2020/02/04/grails-3-datasource-config-with-hibernatespec/" data-title="Grails 3 datasource config with HibernateSpec" data-hashtags="Grails,Grails,Hibernate"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://amuponda.com/2020/02/04/grails-3-datasource-config-with-hibernatespec/" data-hashtag="Grails"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://amuponda.com/2020/02/04/grails-3-datasource-config-with-hibernatespec/" data-title="Grails 3 datasource config with HibernateSpec"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://amuponda.com/2020/02/04/grails-3-datasource-config-with-hibernatespec/" data-title="Grails 3 datasource config with HibernateSpec"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://amuponda.com/2020/02/04/grails-3-datasource-config-with-hibernatespec/" data-title="Grails 3 datasource config with HibernateSpec"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/grails/">Grails</a>,&nbsp;<a href="/tags/grails/">Grails</a>,&nbsp;<a href="/tags/hibernate/">Hibernate</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2019/12/28/handle-exceptions-in-micronaut-scheduled-tasks/" class="prev" rel="prev" title="Handle exceptions in micronaut scheduled tasks"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Handle exceptions in micronaut scheduled tasks</a>
            <a href="/2020/02/08/micronaut-openapi-integration/" class="next" rel="next" title="Micronaut OpenAPI integration">Micronaut OpenAPI integration<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.105.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank"></a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
